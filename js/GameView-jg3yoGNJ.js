import{j as _e,r as p,w as Ee,f as se,B as Se,H as a,J as e,T as d,az as N,S as ae,ap as ne,ac as we,V as w,X as U,ae as ke,M as b,W as n,L as q,aj as De,a2 as Qe,I as l,Y as Ne}from"./vue-BJlp2Mwx.js";import{d as Ue}from"./pinia-BGq-fEY2.js";import{D as ze,a as re,u as Be}from"./deepseekService-Ctd6mtNU.js";import{_ as Ie}from"./vue-helper-DlAUqK2U.js";const Ve=Ue("game",{state:()=>({playerName:"",currentSceneId:1,currentScene:void 0,isGenerating:!1,aiErrorMessage:"",gameLogs:[],storyProgress:{mainQuests:{gaming:0,study:0,social:0,other:0},relationships:{李雪:{character:"李雪",affinity:0,events:[]},王老师:{character:"王老师",affinity:0,events:[]}},flags:new Set},initialScene:{id:1,image:"https://source.unsplash.com/800x500/?classroom,student,chinese&t="+Date.now(),description:'高考倒计时30天，某市第一高中的教室里，小明正心不在焉地听着班主任王老师讲解数学题。但他的心思完全在今晚的游戏排位赛上 —— 作为服务器知名的剑魔玩家"最强剑魔"，他已经连续29天冲击王者失败了。昨晚的直播间里，他又因为激动地大喊"回答我！"把麦克风震炸了。',dialog:'（小明看着手机里的游戏战绩，自言自语）"怎么不找找自己的问题呢...这把打完我要是能拿MVP就好了。"',options:[{text:"专心听课",next:2,hint:"做一个好学生",impact:{quest:{type:"study",value:10},relationship:{character:"王老师",value:5}}},{text:"继续研究剑魔连招",next:3,hint:"今晚一定要上王者",impact:{quest:{type:"gaming",value:10},relationship:{character:"王老师",value:-5}}},{text:"给李雪递纸条",next:4,hint:"要不要约她双排？",impact:{quest:{type:"social",value:5},relationship:{character:"李雪",value:10}}}],context:{mood:"焦虑",location:"教室",timeOfDay:"上午",previousEvents:["昨晚直播麦克风炸了","连续29天冲击王者失败"]},specialEvent:"王老师正在讲解一道高考压轴题，黑板上写满了公式。小明的手机里还在循环播放着昨晚的直播片段。"}}),actions:{setPlayerName(y){this.playerName=y},async startNewGame(){this.currentScene=this.initialScene,this.currentSceneId=1,this.gameLogs=[],this.addGameLog(1,"游戏开始")},async handleChoice(y){var f,u,h,V,A,O;try{this.isGenerating=!0,this.aiErrorMessage="";const g=y.text;this.addGameLog(this.currentSceneId,g),y.impact&&this.processImpact(y.impact);const $=await ze.generateScene({playerName:this.playerName,currentSceneId:this.currentSceneId,choiceText:g,currentScene:this.currentScene,storyProgress:this.storyProgress,streamCallbacks:{onReasoningUpdate:M=>{this.updateReasoningStream(M)},onDialogUpdate:M=>{this.updateDialogStream(M)}}});this.currentScene=$,this.currentSceneId=$.id}catch(g){console.error("处理选择时出错:",g);let $="场景生成遇到问题";g.message&&(g.message.includes("JSON")?$="AI响应格式异常，正在尝试修复...":g.message.includes("network")||g.message.includes("fetch")?$="网络连接问题，请检查网络设置":g.message.includes("401")||g.message.includes("unauthorized")?$="API密钥无效，请检查配置":g.message.includes("429")?$="请求过于频繁，请稍后再试":$=`生成失败: ${g.message}`),this.aiErrorMessage=$,console.log("尝试使用备用场景恢复...");try{const M={id:this.currentSceneId+1,image:`https://source.unsplash.com/800x500/?classroom,student&t=${Date.now()}`,description:`小明在${((u=(f=this.currentScene)==null?void 0:f.context)==null?void 0:u.location)||"教室"}里继续他的故事。虽然刚才遇到了一些小插曲，但生活还在继续。他需要重新整理思路，决定下一步该怎么做。`,dialog:"虽然有些意外，但我要继续前进...这次我要更仔细地考虑。",options:[{text:"专注学习",hint:"把注意力放在功课上",impact:{quest:{type:"study",value:8},relationship:{character:"李雪",value:2}}},{text:"打开游戏",hint:"适当放松调整状态",impact:{quest:{type:"gaming",value:8},relationship:{character:"李雪",value:0}}},{text:"和朋友聊天",hint:"社交也很重要",impact:{quest:{type:"social",value:8},relationship:{character:"李雪",value:3}}}],context:{mood:"坚定",location:((V=(h=this.currentScene)==null?void 0:h.context)==null?void 0:V.location)||"教室",timeOfDay:((O=(A=this.currentScene)==null?void 0:A.context)==null?void 0:O.timeOfDay)||"现在",previousEvents:["遇到技术问题但已恢复"]},isAIGenerated:!1};this.currentScene=M,this.currentSceneId=M.id,this.aiErrorMessage=""}catch(M){console.error("备用场景创建失败:",M)}}finally{this.isGenerating=!1}},processImpact(y){if(y.quest){const{type:f,value:u}=y.quest;f&&typeof u=="number"&&(f==="gaming"&&(this.storyProgress.mainQuests.gaming=Math.min(100,this.storyProgress.mainQuests.gaming+u)),f==="study"&&(this.storyProgress.mainQuests.study=Math.min(100,this.storyProgress.mainQuests.study+u)),f==="social"&&(this.storyProgress.mainQuests.social=Math.min(100,this.storyProgress.mainQuests.social+u)),f==="other"&&(this.storyProgress.mainQuests.other=Math.min(100,this.storyProgress.mainQuests.other+u)))}if(y.relationship){const{character:f,value:u}=y.relationship;if(f&&typeof u=="number"&&this.storyProgress.relationships[f]&&(this.storyProgress.relationships[f].affinity+=u,u!==0)){const h=u>0?"关系改善":"关系恶化";this.storyProgress.relationships[f].events.push(h)}}y.flag&&this.storyProgress.flags.add(y.flag)},updateReasoningStream(y){},updateDialogStream(y){},addGameLog(y,f){this.gameLogs.push({sceneId:y,choiceText:f,timestamp:new Date().toISOString()})},resetGame(){this.currentScene=this.initialScene,this.currentSceneId=1,this.gameLogs=[],this.isGenerating=!1,this.aiErrorMessage="",this.storyProgress={mainQuests:{gaming:0,study:0,social:0,other:0},relationships:{李雪:{character:"李雪",affinity:0,events:[]},王老师:{character:"王老师",affinity:0,events:[]}},flags:new Set}}}}),Oe={class:"min-h-screen bg-gradient-to-br from-white via-slate-50/50 to-gray-50/30 relative"},qe={key:0,class:"relative min-h-screen flex items-center justify-center px-4 sm:px-6"},Le={class:"relative z-10 w-full max-w-7xl mx-auto"},Re={class:"flex flex-col lg:flex-row gap-8 max-w-5xl mx-auto items-center lg:items-start justify-center"},He={class:"flex-1 lg:flex-[2]"},Je={class:"relative group"},We={class:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl shadow-gray-900/10 border border-gray-200/50 p-8 relative overflow-hidden"},Fe={class:"mb-8"},Xe={class:"relative"},Ye=["disabled"],Ze={class:"flex-1 space-y-6"},et={class:"bg-white/95 backdrop-blur-sm rounded-xl p-6 border border-gray-200/60 shadow-lg shadow-gray-900/5"},tt={class:"space-y-4"},st={class:"bg-white/95 backdrop-blur-sm rounded-xl p-6 border border-gray-200/60 shadow-lg shadow-gray-900/5"},at={class:"space-y-2"},lt=["onClick"],ot={class:"pt-4 border-t border-purple-200"},it={class:"flex gap-2"},nt={key:0,class:"fixed inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center z-50"},rt={class:"relative max-w-lg w-full mx-4"},dt={class:"relative overflow-hidden bg-white/90 backdrop-blur-lg rounded-xl sm:rounded-2xl p-8 sm:p-10 shadow-xl border border-white/50"},ut={class:"text-white text-2xl"},gt={class:"text-slate-700 text-center"},vt={class:"flex items-center justify-center gap-2"},mt={key:1,class:"min-h-screen"},pt={class:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 py-6"},ct={class:"fixed bottom-4 right-4 z-40"},xt={key:0,class:"fixed right-4 bottom-20 w-72 sm:w-80 bg-white rounded-xl border border-indigo-100 shadow-xl z-40 overflow-hidden"},bt={class:"bg-gradient-to-r from-indigo-500 to-blue-500 px-4 py-3 flex justify-between items-center"},ft={class:"p-4 max-h-96 overflow-y-auto"},ht={class:"space-y-4"},yt={class:"bg-slate-50 rounded-lg p-3 text-sm border border-slate-100"},wt={class:"space-y-4"},kt={class:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20 hover:bg-white/15 transition-all duration-300"},_t={class:"flex justify-between items-center mb-3"},St={class:"text-blue-200 font-bold text-lg"},It={class:"w-full h-3 bg-white/10 rounded-full overflow-hidden"},Pt={class:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20 hover:bg-white/15 transition-all duration-300"},jt={class:"flex justify-between items-center mb-3"},Ct={class:"text-green-200 font-bold text-lg"},$t={class:"w-full h-3 bg-white/10 rounded-full overflow-hidden"},At={class:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20 hover:bg-white/15 transition-all duration-300"},Mt={class:"flex justify-between items-center mb-3"},Kt={class:"text-purple-200 font-bold text-lg"},Tt={class:"w-full h-3 bg-white/10 rounded-full overflow-hidden"},Gt={class:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20 hover:bg-white/15 transition-all duration-300"},Et={class:"flex justify-between items-center mb-3"},Dt={class:"text-amber-200 font-bold text-lg"},Qt={class:"w-full h-3 bg-white/10 rounded-full overflow-hidden"},Nt={key:0},Ut={class:"bg-slate-50 rounded-lg p-3 text-sm border border-slate-100"},zt={class:"mb-1 font-medium"},Bt={class:"text-xs text-slate-500 space-y-1"},Vt={key:0},Ot={key:1},qt={key:2},Lt={key:3},Rt={key:4},Ht={class:"mt-2 font-medium"},Jt={class:"inline-flex items-center"},Wt={class:"relative flex items-center cursor-pointer"},Ft={key:1,class:"bg-slate-800 text-slate-200 p-3 rounded-lg text-xs font-mono overflow-x-auto"},Xt={class:"rounded-xl sm:rounded-3xl overflow-hidden bg-white border border-slate-100 shadow-lg shadow-indigo-100/50"},Yt={class:"bg-slate-50 border-b border-slate-100 p-4 sm:p-6"},Zt={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4"},es={class:"flex items-center gap-3 sm:gap-4"},ts={class:"text-base sm:text-lg font-bold text-slate-800"},ss={class:"flex flex-wrap items-center gap-2 sm:gap-4 w-full sm:w-auto"},as={class:"px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg sm:rounded-xl bg-slate-50 border border-slate-200 text-slate-700 text-sm"},ls={class:"p-4 sm:p-8 space-y-4 sm:space-y-6 bg-white"},os={class:"mb-4 sm:mb-6 border border-slate-100 rounded-2xl overflow-hidden bg-white"},is={class:"flex border-b border-slate-100"},ns={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-indigo-500"},rs={class:"flex items-center justify-center gap-1 sm:gap-2"},ds={key:0,class:"inline-flex items-center px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full bg-purple-100 text-purple-700 text-xs font-medium"},us={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-purple-500"},gs={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-red-500"},vs={class:"p-4 sm:p-6"},ms={key:0,class:"animate-fadeIn"},ps={class:"flex gap-3 sm:gap-4"},cs={key:0,class:"text-slate-600 italic"},xs={key:1,class:"text-slate-600 italic text-sm sm:text-base"},bs={key:2,class:"text-slate-600 italic text-sm sm:text-base"},fs={key:3,class:"text-amber-600 text-sm sm:text-base italic"},hs={key:4,class:"text-red-600 text-sm sm:text-base"},ys={class:"flex items-center gap-2"},ws={key:5,class:"text-slate-500 text-sm sm:text-base italic"},ks={key:1,class:"animate-fadeIn"},_s={class:"flex gap-3 sm:gap-4"},Ss={key:0,class:"text-slate-600 italic"},Is={class:"text-slate-700 leading-relaxed text-sm sm:text-base"},Ps={key:2,class:"animate-fadeIn"},js={class:"bg-red-50 rounded-lg p-3 sm:p-4 border border-red-100"},Cs={class:"flex items-start gap-2 sm:gap-3"},$s={class:"font-bold text-red-700 flex items-center gap-2 text-sm sm:text-base"},As={key:0},Ms={class:"text-red-600 mt-1 mb-2 text-xs sm:text-sm"},Ks={key:0,class:"text-xs sm:text-sm space-y-2 text-slate-700"},Ts={class:"relative overflow-hidden bg-gradient-to-br from-slate-50 via-indigo-50/30 to-blue-50/30 rounded-xl sm:rounded-2xl p-5 sm:p-7 border border-indigo-100/50 mb-4 sm:mb-6 shadow-lg shadow-indigo-100/20 backdrop-blur-sm group"},Gs={class:"relative flex items-start"},Es={class:"flex-1"},Ds={key:0,class:"text-slate-700 text-sm sm:text-base leading-relaxed font-medium"},Qs={key:1,class:"text-slate-500 text-sm sm:text-base italic"},Ns={key:2,class:"text-amber-600 text-sm sm:text-base"},Us={class:"flex items-center gap-2"},zs={key:3,class:"text-red-600 text-sm sm:text-base"},Bs={class:"flex items-center justify-between gap-2"},Vs={class:"flex items-center gap-2"},Os={key:4,class:"text-slate-600 text-sm sm:text-base"},qs={class:"relative overflow-hidden bg-gradient-to-br from-indigo-50 via-purple-50/20 to-blue-50/20 rounded-xl sm:rounded-2xl p-5 sm:p-7 border border-indigo-200/50 mb-4 sm:mb-6 shadow-lg shadow-indigo-200/20 backdrop-blur-sm group"},Ls={class:"relative flex items-start"},Rs={class:"flex-1"},Hs={class:"bg-white/40 backdrop-blur-sm rounded-lg p-4 border border-indigo-100/50 shadow-sm"},Js={key:0,class:"text-slate-700 text-sm sm:text-base leading-relaxed whitespace-pre-line"},Ws={key:1,class:"text-slate-700 text-sm sm:text-base leading-relaxed whitespace-pre-line"},Fs={key:2,class:"text-slate-500 text-sm sm:text-base italic"},Xs={key:3,class:"text-amber-600 text-sm sm:text-base italic"},Ys={key:4,class:"text-red-600 text-sm sm:text-base"},Zs={class:"flex items-center gap-2"},ea={key:5,class:"text-slate-600 text-sm sm:text-base italic"},ta={key:0,class:"relative overflow-hidden bg-slate-50 rounded-xl sm:rounded-2xl p-4 sm:p-6 border border-indigo-100 mb-4 sm:mb-6"},sa={class:"flex gap-3 sm:gap-4"},aa={class:"text-slate-600 text-sm sm:text-base"},la={class:"grid grid-cols-1 sm:grid-cols-4 gap-3 sm:gap-4 mb-4 sm:mb-6"},oa={class:"bg-white rounded-xl border border-slate-100 p-3 sm:p-4 relative overflow-hidden group"},ia={class:"text-xs sm:text-sm text-slate-500 mb-1 flex justify-between items-center"},na={class:"w-full bg-slate-100 rounded-full h-2 overflow-hidden"},ra={key:0,class:"absolute inset-0 pointer-events-none"},da={class:"bg-white rounded-xl border border-slate-100 p-3 sm:p-4 relative overflow-hidden group"},ua={class:"text-xs sm:text-sm text-slate-500 mb-1 flex justify-between items-center"},ga={class:"w-full bg-slate-100 rounded-full h-2 overflow-hidden"},va={key:0,class:"absolute inset-0 pointer-events-none"},ma={class:"bg-white rounded-xl border border-slate-100 p-3 sm:p-4 relative overflow-hidden group"},pa={class:"text-xs sm:text-sm text-slate-500 mb-1 flex justify-between items-center"},ca={class:"w-full bg-slate-100 rounded-full h-2 overflow-hidden"},xa={key:0,class:"absolute inset-0 pointer-events-none"},ba={class:"bg-white rounded-xl border border-slate-100 p-3 sm:p-4 relative overflow-hidden group"},fa={class:"text-xs sm:text-sm text-slate-500 mb-1 flex justify-between items-center"},ha={class:"w-full bg-slate-100 rounded-full h-2 overflow-hidden"},ya={key:0,class:"absolute inset-0 pointer-events-none"},wa=["onClick"],ka={class:"relative bg-slate-50 rounded-xl sm:rounded-2xl p-4 sm:p-6 border border-slate-100 transform group-hover:-translate-y-1 transition-all duration-300 group-hover:shadow-md group-hover:shadow-indigo-100/50"},_a={class:"text-slate-700 font-medium mb-1 sm:mb-2 text-sm sm:text-base"},Sa={key:0,class:"text-slate-500 text-xs sm:text-sm italic"},Ia={key:1,class:"absolute top-2 right-2 flex items-center justify-center"},Pa={key:0,class:"text-center py-8"},ja={key:1,class:"text-center py-8"},Ca={class:"space-y-4"},$a={class:"text-base sm:text-lg font-medium text-slate-800"},Aa={class:"mt-2 space-y-2"},Ma={key:0,class:"flex items-start gap-2"},Ka={key:1,class:"flex items-start gap-2"},Ta={key:2,class:"flex items-start gap-2"},Ga={key:3,class:"flex items-start gap-2"},Ea={key:1,class:"fixed inset-0 bg-white/90 backdrop-blur-sm flex items-center justify-center z-50"},Da={class:"relative"},Qa={class:"relative bg-white rounded-xl sm:rounded-2xl p-6 sm:p-8 border border-slate-100 shadow-lg shadow-indigo-100/50"},Na={class:"text-slate-500 text-xs sm:text-sm text-center mt-2"},Ua={key:0},za={key:1},Ba={key:2,class:"fixed bottom-4 sm:bottom-8 left-1/2 -translate-x-1/2 z-50"},Va={class:"relative"},Oa={class:"relative bg-white px-4 sm:px-6 py-3 sm:py-4 rounded-xl border border-red-100 text-red-500 flex items-center gap-2 sm:gap-3 shadow-lg shadow-red-100/50 text-sm sm:text-base"},qa={class:"font-medium"},La=_e({__name:"GiaoGame",props:{apiBaseUrl:{type:String,default:""}},setup(y){const f=y,u=Ve(),h=p(""),V=p(!0),A=p("https://api.siliconflow.cn/v1/chat/completions"),O=p("sk-etybbrewlaafxjjqtlgfeqaaskzrmryfndjtjjecyixbsznw"),g=p("deepseek-ai/DeepSeek-R1-Distill-Qwen-7B");p("story");const $=p(""),M=p(!1),X=p(!1),K=p(""),G=p(!1),C=p(""),E=p(!1),Y=p(""),W=p(!1),Z=p(""),z=p(""),i=p(""),o=p({gaming:25,study:10,social:5,other:0});p([{role:"assistant",content:"欢迎来到 AI 互动游戏！请选择你想要的游戏模式，我们将开始一段奇妙的旅程。"}]);const me=p(!1),Pe={400:{title:"格式错误",reason:"请求体格式错误",solution:"请根据错误信息提示修改请求体"},401:{title:"认证失败",reason:"API key 错误，认证失败",solution:"请检查您的 API key 是否正确，如没有 API key，请先创建 API key"},402:{title:"余额不足",reason:"账号余额不足",solution:"请确认账户余额，并前往充值页面进行充值"},422:{title:"参数错误",reason:"请求体参数错误",solution:"请根据错误信息提示修改相关参数"},429:{title:"请求速率达到上限",reason:"请求速率（TPM 或 RPM）达到上限",solution:"请合理规划您的请求速率"},500:{title:"服务器故障",reason:"服务器内部故障",solution:"请等待后重试。若问题一直存在，请联系我们解决"},503:{title:"服务器繁忙",reason:"服务器负载过高",solution:"请稍后重试您的请求"}},T=p({show:!1,code:"",message:"",details:null}),x=p("dialog");Ee(()=>f.apiBaseUrl,s=>{s&&(A.value=s,re({baseUrl:s}),console.log("游戏组件: API地址已更新为",s))},{immediate:!0});const k=se(()=>u.currentScene),D=se(()=>u.isGenerating),S=se(()=>u.aiErrorMessage),de=s=>{g.value=s,re({baseUrl:A.value,apiKey:O.value,model:s}),console.log("模型已更新为:",s)},pe=async()=>{if(!h.value){alert("请输入你的名字");return}A.value&&re({baseUrl:A.value,apiKey:O.value,model:g.value}),M.value=!0;try{u.setPlayerName(h.value),V.value=!1,await u.startNewGame(),Ce()}catch(s){console.error("游戏启动错误:",s),alert("游戏启动失败，请检查API设置或稍后再试")}finally{M.value=!1}},ce=()=>{u.$onAction(({name:s,args:t})=>{s==="updateReasoningStream"&&t[0]&&(K.value+=t[0],g.value!=="deepseek-chat"&&K.value&&x.value==="dialog"&&(x.value="reasoning")),s==="updateDialogStream"&&t[0]&&(C.value+=t[0],C.value&&x.value==="reasoning"&&(x.value="dialog"))}),me.value=!0,console.log("已设置流式监听器")},je=async s=>{var t;try{if(K.value="",C.value="",G.value=g.value!=="deepseek-chat",E.value=!0,ee(),me.value||ce(),console.log(s),s.impact)xe(s.impact),c.value={text:s.text,matchedKeywords:{gaming:[],study:[],social:[],other:[]},impactType:((t=s.impact.quest)==null?void 0:t.type)||"other",impactText:""};else{const m=s.text.toLowerCase(),r={gaming:0,study:0,social:0,other:0},L=["游戏","剑魔","技能","排位","连招","对线","比赛","击败","电竞","英雄","段位","LOL","打野","屏幕","键盘","打游戏","王者","MVP","玩家"],R=["学习","考试","上课","听讲","作业","专心","知识","读书","笔记","成绩","课程","教授","学校","老师","教室","课本","学科","复习","思考"],H=["朋友","社交","关系","交流","合作","团队","聚会","聚餐","派对","沟通","网友","约会","同学会","女生","男生","聚在一起"],J=["神秘","命运","思考","冥想","灵感","直觉","预感","奇怪","奇特","感悟","超自然","第六感","梦境","星象","符文"];let B=0,I={gaming:[],study:[],social:[],other:[]};L.forEach(j=>{m.includes(j)&&(r.gaming+=1,B+=1,I.gaming.push(j))}),R.forEach(j=>{m.includes(j)&&(r.study+=1,B+=1,I.study.push(j))}),H.forEach(j=>{m.includes(j)&&(r.social+=1,B+=1,I.social.push(j))}),J.forEach(j=>{m.includes(j)&&(r.other+=1,B+=1,I.other=I.other||[],I.other.push(j))}),r.social>0&&r.social<=2&&(r.social*=.7),r.other>0&&(r.other*=1.2),console.log("选项文本:",m),console.log("匹配到的关键词:",I),console.log("调整权重后分数:",r),console.log("总匹配关键词数:",B),B===0&&(r.other=1,console.log('未匹配到任何关键词，增加"其他"能力'));let _="gaming",P=-1,Q="gaming";o.value.study<o.value[Q]&&(Q="study"),o.value.social<o.value[Q]&&(Q="social"),o.value.other<o.value[Q]&&(Q="other"),r.gaming>P&&(P=r.gaming,_="gaming"),r.study>P?(P=r.study,_="study"):r.study===P&&o.value.study<o.value[_]&&(_="study"),r.social>P?(P=r.social,_="social"):r.social===P&&o.value.social<o.value[_]&&(_="social"),r.other>P?(P=r.other,_="other"):r.other===P&&o.value.other<o.value[_]&&(_="other"),r.gaming===r.study&&r.study===r.social&&r.social===r.other&&(_=Q);const oe=5,ie=Math.min(3,Math.floor(s.text.length/20)),te=oe+ie;console.log("选项分析:",{text:m,scores:r,selected:_,value:te,currentProgress:o.value}),c.value={text:s.text,matchedKeywords:{gaming:I.gaming||[],study:I.study||[],social:I.social||[],other:I.other||[]},impactType:_,impactText:""},xe({quest:{type:_,value:te}})}g.value==="deepseek-chat"?x.value="dialog":x.value="reasoning",await u.handleChoice(s),k.value&&Ge(k.value),G.value=!1,E.value=!1}catch(m){console.error("处理选择时出错:",m),G.value=!1,E.value=!1,fe(m)}},xe=s=>{if(s.quest){const{type:t,value:m}=s.quest;t==="gaming"&&(o.value.gaming=Math.min(100,o.value.gaming+m)),t==="study"&&(o.value.study=Math.min(100,o.value.study+m)),t==="social"&&(o.value.social=Math.min(100,o.value.social+m)),t==="other"&&(o.value.other=Math.min(100,o.value.other+m)),be()}},be=()=>{const s=[];if(o.value.gaming>=100&&s.push("gaming"),o.value.study>=100&&s.push("study"),o.value.social>=100&&s.push("social"),o.value.other>=100&&s.push("other"),s.length===0||W.value)return;const t=s[0];t==="gaming"?(Z.value="游戏大师",z.value=`恭喜${h.value}！你在游戏技能方面达到了顶峰！你成为了传说中的电竞选手！`,s.length>1&&(z.value+=`

另外，你也在${s.includes("study")?"学业":""}${s.includes("study")&&s.includes("social")?"和":""}${s.includes("social")?"社交":""}方面表现出色！`),i.value="gaming"):t==="study"?(Z.value="学霸之路",z.value=`恭喜${h.value}！你在学业上取得了令人瞩目的成就！成为了学院最年轻的教授！`,s.length>1&&(z.value+=`

另外，你也在${s.includes("gaming")?"游戏":""}${s.includes("gaming")&&s.includes("social")?"和":""}${s.includes("social")?"社交":""}方面表现出色！`),i.value="study"):t==="social"?(Z.value="社交之星",z.value=`恭喜${h.value}！你的社交能力已经炉火纯青！成为了人际关系网络的中心，拥有无数忠实的朋友！`,s.length>1&&(z.value+=`

另外，你也在${s.includes("gaming")?"游戏":""}${s.includes("gaming")&&s.includes("study")?"和":""}${s.includes("study")?"学业":""}方面表现出色！`),i.value="social"):t==="other"&&(Z.value="神秘技能",z.value=`恭喜${h.value}！你掌握了一种无法言明的神秘能力！似乎命运的齿轮在你手中转动！`,s.length>1&&(z.value+=`

另外，你也在${s.includes("gaming")?"游戏":""}${s.includes("gaming")&&(s.includes("study")||s.includes("social"))?"、":""}${s.includes("study")?"学业":""}${(s.includes("gaming")||s.includes("study"))&&s.includes("social")?"和":""}${s.includes("social")?"社交":""}方面表现出色！`),i.value="other"),W.value=!0},Ce=()=>{var s,t,m,r,L,R,H,J;o.value={gaming:((t=(s=u.storyProgress)==null?void 0:s.mainQuests)==null?void 0:t.gaming)||25,study:((r=(m=u.storyProgress)==null?void 0:m.mainQuests)==null?void 0:r.study)||10,social:((R=(L=u.storyProgress)==null?void 0:L.mainQuests)==null?void 0:R.social)||5,other:((J=(H=u.storyProgress)==null?void 0:H.mainQuests)==null?void 0:J.other)||0},be()},$e=()=>{confirm("确定要重置游戏进度吗？")&&(C.value="",K.value="",$.value="",x.value="dialog",W.value=!1,G.value=!1,E.value=!1,ee(),u.resetGame(),o.value={gaming:25,study:10,social:5,other:0})},Ae=()=>{X.value=!X.value},Me=()=>{const s=["deepseek-ai/DeepSeek-R1-Distill-Qwen-7B","deepseek-r1","deepseek-chat","QwQ-32B"],m=(s.indexOf(g.value)+1)%s.length;K.value="",C.value="",de(s[m]),s[m]==="deepseek-chat"&&x.value==="reasoning"&&(x.value="dialog"),X.value=!1},ue=s=>{x.value=s},fe=s=>{var t;if(G.value=!1,E.value=!1,(t=s==null?void 0:s.response)!=null&&t.status){const m=s.response.status.toString();T.value={show:!0,code:m,message:s.message||"未知错误",details:Pe[m]||null}}else{const m=(s==null?void 0:s.message)||"连接失败，请检查API地址和网络连接";T.value={show:!0,code:"UNKNOWN",message:m,details:{title:"连接错误",reason:"无法连接到API服务器或请求被中断",solution:"请检查API地址是否正确，网络连接是否稳定，或API密钥是否有效"}}}x.value="error"},ee=()=>{T.value.show=!1,x.value==="error"&&(x.value="dialog")};Se(()=>{f.apiBaseUrl&&(A.value=f.apiBaseUrl),re({baseUrl:A.value,apiKey:O.value,model:g.value}),ce()});const he=()=>{if(Y.value){const s=Y.value.trim();if(!s)return;K.value="",C.value="",de(s),Y.value=""}},ge=()=>{console.log("开始返回首页");try{C.value="",K.value="",$.value="",x.value="dialog",W.value=!1,G.value=!1,E.value=!1,ee(),u.resetGame(),o.value={gaming:25,study:10,social:5,other:0},V.value=!0,console.log("已返回游戏首页",V.value)}catch(s){console.error("返回首页出错:",s)}},Ke=()=>{W.value=!1,ge()},ye=async()=>{try{ee(),u.aiErrorMessage="",C.value="",K.value="",G.value=g.value!=="deepseek-chat",E.value=!0;const s={text:"继续当前场景",next:u.currentSceneId};console.log("开始重新生成场景..."),await u.handleChoice(s),console.log("场景重新生成成功"),G.value=!1,E.value=!1}catch(s){console.error("重新生成场景失败:",s),G.value=!1,E.value=!1,fe(s)}},le=p(!1),c=p({text:"",matchedKeywords:{gaming:[],study:[],social:[],other:[]},impactType:"gaming",impactText:""}),ve=p(!1),F=p({lastChoice:{text:"",matchedKeywords:{gaming:[],study:[],social:[],other:[]},impactType:"gaming",impactText:""},currentScene:{id:1,dialog:"",reasoning:"",specialEvent:"",options:[]}}),Te=se(()=>{switch(c.value.impactType){case"gaming":return"游戏技能";case"study":return"学习能力";case"social":return"社交关系";case"other":return"神秘能力";default:return""}});se(()=>`当前场景: ${F.value.currentScene.id}
对话: ${F.value.currentScene.dialog}
思维过程: ${F.value.currentScene.reasoning}
特殊事件: ${F.value.currentScene.specialEvent}`);const Ge=s=>{F.value={lastChoice:{text:c.value.text,matchedKeywords:{gaming:[...c.value.matchedKeywords.gaming],study:[...c.value.matchedKeywords.study],social:[...c.value.matchedKeywords.social],other:[...c.value.matchedKeywords.other||[]]},impactType:c.value.impactType,impactText:c.value.impactText},currentScene:{id:s.id,dialog:s.dialog,reasoning:s.reasoning,specialEvent:s.specialEvent,options:s.options}}};return(s,t)=>{var m,r,L,R,H,J,B,I,_,P,Q,oe,ie,te;return l(),a("div",Oe,[t[108]||(t[108]=e("div",{class:"absolute inset-0 overflow-hidden pointer-events-none"},[e("div",{class:"absolute top-1/3 left-1/4 w-80 h-80 bg-gradient-to-br from-blue-100/40 to-indigo-100/30 rounded-full blur-3xl"}),e("div",{class:"absolute bottom-1/3 right-1/4 w-80 h-80 bg-gradient-to-br from-violet-100/40 to-purple-100/30 rounded-full blur-3xl"}),e("div",{class:"absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(99,102,241,0.03),transparent_50%)]"})],-1)),V.value?(l(),a("div",qe,[e("div",Le,[t[20]||(t[20]=N('<div class="text-center mb-12" data-v-0187d014><div class="mb-12" data-v-0187d014><div class="inline-flex items-center justify-center w-24 h-24 rounded-2xl bg-gradient-to-br from-indigo-500 via-purple-500 to-violet-500 shadow-xl shadow-indigo-500/20 mb-8 relative group border border-indigo-200/30" data-v-0187d014><div class="absolute inset-0 rounded-2xl bg-gradient-to-br from-white/20 to-transparent" data-v-0187d014></div><span class="text-4xl relative z-10 filter brightness-110" data-v-0187d014>⚔️</span><div class="absolute -inset-1 rounded-2xl bg-gradient-to-br from-indigo-200/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500" data-v-0187d014></div></div><h1 class="text-4xl sm:text-6xl md:text-7xl font-bold mb-6 tracking-tight" data-v-0187d014><span class="bg-gradient-to-r from-indigo-600 via-purple-600 to-violet-600 bg-clip-text text-transparent" data-v-0187d014> 剑道传奇 </span></h1><p class="text-base sm:text-lg text-gray-600 max-w-xl mx-auto leading-relaxed font-normal" data-v-0187d014> 在这个充满挑战的武侠世界中，你将扮演一名初入江湖的剑客 </p></div><div class="flex flex-wrap justify-center gap-3 mb-12" data-v-0187d014><div class="px-5 py-2.5 bg-white/80 backdrop-blur-sm rounded-full border border-gray-200/60 shadow-sm hover:shadow-md hover:border-gray-300/60 transition-all duration-300 group" data-v-0187d014><span class="text-sm font-medium text-gray-700 group-hover:text-gray-900 flex items-center gap-2" data-v-0187d014><span class="text-base" data-v-0187d014>🎮</span> 互动剧情 </span></div><div class="px-5 py-2.5 bg-white/80 backdrop-blur-sm rounded-full border border-gray-200/60 shadow-sm hover:shadow-md hover:border-gray-300/60 transition-all duration-300 group" data-v-0187d014><span class="text-sm font-medium text-gray-700 group-hover:text-gray-900 flex items-center gap-2" data-v-0187d014><span class="text-base" data-v-0187d014>🤖</span> AI驱动 </span></div><div class="px-5 py-2.5 bg-white/80 backdrop-blur-sm rounded-full border border-gray-200/60 shadow-sm hover:shadow-md hover:border-gray-300/60 transition-all duration-300 group" data-v-0187d014><span class="text-sm font-medium text-gray-700 group-hover:text-gray-900 flex items-center gap-2" data-v-0187d014><span class="text-base" data-v-0187d014>📈</span> 成长系统 </span></div></div></div>',1)),e("div",Re,[e("div",He,[e("div",Je,[e("div",We,[t[14]||(t[14]=N('<div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-300 via-purple-400 to-violet-300" data-v-0187d014></div><div class="absolute top-6 right-6 w-12 h-12 bg-gradient-to-br from-indigo-100 to-purple-100 rounded-full opacity-60" data-v-0187d014></div><div class="text-center mb-8" data-v-0187d014><h2 class="text-2xl font-semibold text-indigo-800 mb-3" data-v-0187d014>开始你的传奇</h2><p class="text-purple-600 font-normal text-sm leading-relaxed" data-v-0187d014>输入你的名字，踏上剑道修行之路</p></div>',3)),e("div",Fe,[e("div",Xe,[ae(e("input",{"onUpdate:modelValue":t[0]||(t[0]=v=>h.value=v),type:"text",placeholder:"请输入你的剑客名字...",class:"w-full px-5 py-4 pl-12 bg-indigo-50/80 rounded-xl border border-indigo-200 text-indigo-900 placeholder-indigo-400 focus:outline-none focus:border-indigo-400 focus:ring-2 focus:ring-indigo-300/50 focus:bg-white transition-all duration-300 text-base font-normal shadow-sm hover:shadow-md hover:border-indigo-300",onKeyup:we(pe,["enter"])},null,544),[[ne,h.value]]),t[12]||(t[12]=e("span",{class:"absolute left-4 top-1/2 -translate-y-1/2 text-lg text-indigo-400"},"⚔️",-1))])]),e("button",{onClick:pe,disabled:!h.value,class:"w-full group relative overflow-hidden"},t[13]||(t[13]=[N('<div class="absolute inset-0 bg-gradient-to-r from-indigo-600 via-purple-600 to-violet-600 rounded-xl" data-v-0187d014></div><div class="absolute inset-0 bg-gradient-to-r from-indigo-500 via-purple-500 to-violet-500 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300" data-v-0187d014></div><div class="relative px-6 py-4 text-white font-medium text-base transform group-hover:-translate-y-0.5 group-active:translate-y-0 transition-all duration-200 group-disabled:opacity-50 group-disabled:cursor-not-allowed group-disabled:transform-none" data-v-0187d014><span class="flex items-center justify-center gap-3" data-v-0187d014><span class="text-lg" data-v-0187d014>🗡️</span><span data-v-0187d014>踏上剑道之路</span><span class="text-lg" data-v-0187d014>✨</span></span></div><div class="absolute inset-0 rounded-xl bg-gradient-to-r from-white/10 via-transparent to-white/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300" data-v-0187d014></div>',4)]),8,Ye),t[15]||(t[15]=N('<div class="mt-8 grid grid-cols-1 sm:grid-cols-3 gap-3" data-v-0187d014><div class="text-center p-4 bg-indigo-50/60 rounded-lg border border-indigo-100 hover:shadow-md hover:border-indigo-200 transition-all duration-300 group" data-v-0187d014><div class="text-xl mb-2 group-hover:scale-105 transition-transform duration-300" data-v-0187d014>🎯</div><div class="text-xs font-medium text-indigo-700 group-hover:text-indigo-900" data-v-0187d014>多重选择</div></div><div class="text-center p-4 bg-purple-50/60 rounded-lg border border-purple-100 hover:shadow-md hover:border-purple-200 transition-all duration-300 group" data-v-0187d014><div class="text-xl mb-2 group-hover:scale-105 transition-transform duration-300" data-v-0187d014>⚡</div><div class="text-xs font-medium text-purple-700 group-hover:text-purple-900" data-v-0187d014>能力成长</div></div><div class="text-center p-4 bg-violet-50/60 rounded-lg border border-violet-100 hover:shadow-md hover:border-violet-200 transition-all duration-300 group" data-v-0187d014><div class="text-xl mb-2 group-hover:scale-105 transition-transform duration-300" data-v-0187d014>🌟</div><div class="text-xs font-medium text-violet-700 group-hover:text-violet-900" data-v-0187d014>动态剧情</div></div></div>',1))])]),e("div",Ze,[e("div",et,[t[18]||(t[18]=e("h3",{class:"text-lg font-semibold text-indigo-800 mb-6 flex items-center gap-3"},[e("span",{class:"w-7 h-7 rounded-lg bg-gradient-to-br from-indigo-100 to-purple-100 flex items-center justify-center text-sm border border-indigo-200"},"🔧"),w(" API 配置 ")],-1)),e("div",tt,[e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-indigo-700 mb-2"},"API 地址",-1)),ae(e("input",{"onUpdate:modelValue":t[1]||(t[1]=v=>A.value=v),type:"text",placeholder:"请输入API地址",class:"w-full px-4 py-3 bg-indigo-50/80 rounded-lg border border-indigo-200 text-indigo-800 placeholder-indigo-400 focus:outline-none focus:border-indigo-400 focus:ring-2 focus:ring-indigo-300/50 focus:bg-white transition-all duration-200 text-sm"},null,512),[[ne,A.value]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-indigo-700 mb-2"},"API Key",-1)),ae(e("input",{"onUpdate:modelValue":t[2]||(t[2]=v=>O.value=v),type:"password",placeholder:"请输入您的API密钥",class:"w-full px-4 py-3 bg-indigo-50/80 rounded-lg border border-indigo-200 text-indigo-800 placeholder-indigo-400 focus:outline-none focus:border-indigo-400 focus:ring-2 focus:ring-indigo-300/50 focus:bg-white transition-all duration-200 text-sm"},null,512),[[ne,O.value]])])])]),e("div",st,[t[19]||(t[19]=e("h3",{class:"text-lg font-semibold text-purple-800 mb-6 flex items-center gap-3"},[e("span",{class:"w-7 h-7 rounded-lg bg-gradient-to-br from-purple-100 to-violet-100 flex items-center justify-center text-sm border border-purple-200"},"🤖"),w(" 模型选择 ")],-1)),e("div",at,[(l(),a(U,null,ke(["deepseek-ai/DeepSeek-R1-Distill-Qwen-7B","deepseek-r1","deepseek-chat","QwQ-32B"],v=>e("button",{key:v,onClick:j=>de(v),class:b(["w-full px-4 py-3 text-sm rounded-lg transition-all duration-200 text-left font-medium",g.value===v?"bg-gradient-to-r from-purple-600 to-violet-600 text-white shadow-md":"bg-purple-50/80 text-purple-700 border border-purple-200 hover:bg-purple-100 hover:border-purple-300"])},n(v),11,lt)),64)),e("div",ot,[e("div",it,[ae(e("input",{"onUpdate:modelValue":t[3]||(t[3]=v=>Y.value=v),type:"text",placeholder:"自定义模型",class:"flex-1 px-3 py-2 bg-purple-50/80 rounded-lg border border-purple-200 text-purple-800 placeholder-purple-400 text-sm focus:outline-none focus:border-purple-400 focus:bg-white transition-all duration-200",onKeyup:we(he,["enter"])},null,544),[[ne,Y.value]]),e("button",{onClick:he,class:"px-4 py-2 bg-gradient-to-r from-purple-600 to-violet-600 text-white rounded-lg text-sm hover:from-purple-500 hover:to-violet-500 transition-all duration-200 font-medium"}," 设置 ")])])])])])])])]),W.value?(l(),a("div",nt,[e("div",rt,[e("div",{class:b(["absolute -inset-4 rounded-3xl",{"bg-gradient-to-br from-blue-600/20 to-indigo-600/20":i.value==="gaming","bg-gradient-to-br from-green-600/20 to-emerald-600/20":i.value==="study","bg-gradient-to-br from-purple-600/20 to-indigo-600/20":i.value==="social","bg-gradient-to-br from-amber-600/20 to-orange-600/20":i.value==="other"}])},null,2),e("div",dt,[e("div",{class:b(["absolute top-0 left-0 w-full h-[2px]",{"bg-gradient-to-r from-transparent via-blue-400 to-transparent":i.value==="gaming","bg-gradient-to-r from-transparent via-green-400 to-transparent":i.value==="study","bg-gradient-to-r from-transparent via-purple-400 to-transparent":i.value==="social","bg-gradient-to-r from-transparent via-amber-400 to-transparent":i.value==="other"}])},null,2),e("div",{class:b(["absolute -top-24 -right-24 w-48 h-48 rounded-full blur-3xl animate-pulse-slow",{"bg-blue-500/10":i.value==="gaming","bg-green-500/10":i.value==="study","bg-purple-500/10":i.value==="social","bg-amber-500/10":i.value==="other"}])},null,2),e("div",{class:b(["absolute -bottom-24 -left-24 w-48 h-48 rounded-full blur-3xl animate-pulse-slow",{"bg-blue-600/10":i.value==="gaming","bg-emerald-500/10":i.value==="study","bg-indigo-600/10":i.value==="social","bg-orange-600/10":i.value==="other"}])},null,2),e("div",{class:b(["w-16 h-16 mx-auto mb-6 rounded-full flex items-center justify-center",{"bg-gradient-to-br from-blue-500 to-indigo-600":i.value==="gaming","bg-gradient-to-br from-green-500 to-emerald-600":i.value==="study","bg-gradient-to-br from-purple-500 to-indigo-600":i.value==="social","bg-gradient-to-br from-amber-500 to-orange-600":i.value==="other"}])},[e("span",ut,[i.value==="gaming"?(l(),a(U,{key:0},[w("🎮")],64)):i.value==="study"?(l(),a(U,{key:1},[w("🎓")],64)):i.value==="social"?(l(),a(U,{key:2},[w("👥")],64)):(l(),a(U,{key:3},[w("✨")],64))])],2),e("h2",{class:b(["text-2xl sm:text-3xl font-bold text-center mb-2 bg-clip-text text-transparent",{"bg-gradient-to-r from-blue-600 to-indigo-600":i.value==="gaming","bg-gradient-to-r from-green-600 to-emerald-600":i.value==="study","bg-gradient-to-r from-purple-600 to-indigo-600":i.value==="social","bg-gradient-to-r from-amber-600 to-orange-600":i.value==="other"}])},n(Z.value),3),e("div",{class:b(["w-1/3 h-[1px] mx-auto mb-6",{"bg-gradient-to-r from-transparent via-blue-300 to-transparent":i.value==="gaming","bg-gradient-to-r from-transparent via-green-300 to-transparent":i.value==="study","bg-gradient-to-r from-transparent via-purple-300 to-transparent":i.value==="social","bg-gradient-to-r from-transparent via-amber-300 to-transparent":i.value==="other"}])},null,2),e("div",{class:b(["bg-white/60 rounded-lg p-4 mb-6 border",{"border-blue-100":i.value==="gaming","border-green-100":i.value==="study","border-purple-100":i.value==="social","border-amber-100":i.value==="other"}])},[e("p",gt,n(z.value),1)],2),e("button",{onClick:Ke,class:b(["w-full py-3 rounded-xl font-medium text-white transition transform hover:-translate-y-1 hover:shadow-lg",{"bg-gradient-to-r from-blue-500 to-indigo-600 hover:shadow-blue-200/50":i.value==="gaming","bg-gradient-to-r from-green-500 to-emerald-600 hover:shadow-green-200/50":i.value==="study","bg-gradient-to-r from-purple-500 to-indigo-600 hover:shadow-purple-200/50":i.value==="social","bg-gradient-to-r from-amber-500 to-orange-600 hover:shadow-amber-200/50":i.value==="other"}])},[e("span",vt,[t[21]||(t[21]=e("span",null,"继续冒险",-1)),i.value==="gaming"?(l(),a(U,{key:0},[w("🎮")],64)):i.value==="study"?(l(),a(U,{key:1},[w("📚")],64)):i.value==="social"?(l(),a(U,{key:2},[w("🌟")],64)):(l(),a(U,{key:3},[w("✨")],64))])],2)])])])):d("",!0)])):(l(),a("div",mt,[t[107]||(t[107]=e("div",{class:"absolute inset-0 overflow-hidden pointer-events-none"},[e("div",{class:"absolute top-1/4 left-1/4 w-96 h-96 bg-indigo-500/10 rounded-full blur-3xl"}),e("div",{class:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl"})],-1)),e("div",pt,[e("div",ct,[e("button",{onClick:t[4]||(t[4]=v=>le.value=!le.value),class:"w-12 h-12 rounded-full bg-gradient-to-r from-indigo-500 to-blue-500 flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1"},t[22]||(t[22]=[e("span",{class:"text-white text-xl"},"📖",-1)]))]),le.value?(l(),a("div",xt,[e("div",bt,[t[23]||(t[23]=e("h3",{class:"text-white font-medium"},"游戏手册",-1)),e("button",{onClick:t[5]||(t[5]=v=>le.value=!1),class:"text-white hover:text-indigo-100"},"×")]),e("div",ft,[e("div",ht,[e("div",null,[t[27]||(t[27]=e("h4",{class:"font-bold text-slate-700 mb-2 flex items-center gap-2"},[e("span",{class:"text-indigo-500"},"🎮"),e("span",null,"当前状态")],-1)),e("div",yt,[e("div",null,[t[24]||(t[24]=e("span",{class:"font-medium"},"玩家:",-1)),w(" "+n(h.value),1)]),e("div",null,[t[25]||(t[25]=e("span",{class:"font-medium"},"场景:",-1)),w(" "+n(((m=k.value)==null?void 0:m.id)||"初始"),1)]),e("div",null,[t[26]||(t[26]=e("span",{class:"font-medium"},"模型:",-1)),w(" "+n(g.value),1)])])]),e("div",null,[t[32]||(t[32]=e("h4",{class:"font-bold text-white mb-6 flex items-center gap-3"},[e("span",{class:"w-8 h-8 rounded-lg bg-gradient-to-br from-indigo-400 to-purple-500 flex items-center justify-center text-sm"},"📊"),e("span",null,"能力值")],-1)),e("div",wt,[e("div",kt,[e("div",_t,[t[28]||(t[28]=e("div",{class:"flex items-center gap-3"},[e("span",{class:"text-2xl"},"🎮"),e("span",{class:"text-blue-300 font-medium"},"游戏技能")],-1)),e("span",St,n(Math.round(o.value.gaming))+"%",1)]),e("div",It,[e("div",{class:"h-full bg-gradient-to-r from-blue-400 to-blue-600 rounded-full transition-all duration-700 shadow-lg shadow-blue-500/25",style:q(`width: ${o.value.gaming}%`)},null,4)])]),e("div",Pt,[e("div",jt,[t[29]||(t[29]=e("div",{class:"flex items-center gap-3"},[e("span",{class:"text-2xl"},"📚"),e("span",{class:"text-green-300 font-medium"},"学习能力")],-1)),e("span",Ct,n(Math.round(o.value.study))+"%",1)]),e("div",$t,[e("div",{class:"h-full bg-gradient-to-r from-green-400 to-green-600 rounded-full transition-all duration-700 shadow-lg shadow-green-500/25",style:q(`width: ${o.value.study}%`)},null,4)])]),e("div",At,[e("div",Mt,[t[30]||(t[30]=e("div",{class:"flex items-center gap-3"},[e("span",{class:"text-2xl"},"👥"),e("span",{class:"text-purple-300 font-medium"},"社交关系")],-1)),e("span",Kt,n(Math.round(o.value.social))+"%",1)]),e("div",Tt,[e("div",{class:"h-full bg-gradient-to-r from-purple-400 to-purple-600 rounded-full transition-all duration-700 shadow-lg shadow-purple-500/25",style:q(`width: ${o.value.social}%`)},null,4)])]),e("div",Gt,[e("div",Et,[t[31]||(t[31]=e("div",{class:"flex items-center gap-3"},[e("span",{class:"text-2xl"},"✨"),e("span",{class:"text-amber-300 font-medium"},"神秘能力")],-1)),e("span",Dt,n(Math.round(o.value.other))+"%",1)]),e("div",Qt,[e("div",{class:"h-full bg-gradient-to-r from-amber-400 to-amber-600 rounded-full transition-all duration-700 shadow-lg shadow-amber-500/25",style:q(`width: ${o.value.other}%`)},null,4)])])])]),c.value.text?(l(),a("div",Nt,[t[38]||(t[38]=e("h4",{class:"font-bold text-slate-700 mb-2 flex items-center gap-2"},[e("span",{class:"text-indigo-500"},"🔍"),e("span",null,"上次选择分析")],-1)),e("div",Ut,[e("div",zt,'选择: "'+n(c.value.text)+'"',1),e("div",Bt,[(r=c.value.matchedKeywords.gaming)!=null&&r.length?(l(),a("div",Vt,[t[33]||(t[33]=e("span",{class:"text-blue-600 font-medium"},"游戏关键词:",-1)),w(" "+n(c.value.matchedKeywords.gaming.join(", ")),1)])):d("",!0),(L=c.value.matchedKeywords.study)!=null&&L.length?(l(),a("div",Ot,[t[34]||(t[34]=e("span",{class:"text-green-600 font-medium"},"学习关键词:",-1)),w(" "+n(c.value.matchedKeywords.study.join(", ")),1)])):d("",!0),(R=c.value.matchedKeywords.social)!=null&&R.length?(l(),a("div",qt,[t[35]||(t[35]=e("span",{class:"text-purple-600 font-medium"},"社交关键词:",-1)),w(" "+n(c.value.matchedKeywords.social.join(", ")),1)])):d("",!0),(H=c.value.matchedKeywords.other)!=null&&H.length?(l(),a("div",Lt,[t[36]||(t[36]=e("span",{class:"text-amber-600 font-medium"},"神秘关键词:",-1)),w(" "+n(c.value.matchedKeywords.other.join(", ")),1)])):d("",!0),Object.values(c.value.matchedKeywords).some(v=>v==null?void 0:v.length)?d("",!0):(l(),a("div",Rt," 无匹配关键词，增加了神秘能力 ")),e("div",Ht,[t[37]||(t[37]=w(" 增加了: ")),e("span",{class:b({"text-blue-600":c.value.impactType==="gaming","text-green-600":c.value.impactType==="study","text-purple-600":c.value.impactType==="social","text-amber-600":c.value.impactType==="other"})},n(Te.value),3)])])])])):d("",!0),e("div",null,[e("div",Jt,[e("label",Wt,[ae(e("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=v=>ve.value=v),class:"sr-only peer"},null,512),[[De,ve.value]]),t[39]||(t[39]=e("div",{class:"w-9 h-5 bg-slate-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-100 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-indigo-500"},null,-1)),t[40]||(t[40]=e("span",{class:"ml-2 text-xs font-medium text-slate-600"},"显示调试信息",-1))])])]),ve.value?(l(),a("div",Ft,[e("pre",null,n(JSON.stringify(F.value,null,2)),1)])):d("",!0)])])])):d("",!0),e("div",Xt,[e("div",Yt,[e("div",Zt,[e("div",es,[t[42]||(t[42]=e("div",{class:"w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-gradient-to-br from-indigo-500 to-blue-500 p-[1px]"},[e("div",{class:"w-full h-full rounded-[10px] bg-white flex items-center justify-center"},[e("span",{class:"text-xl sm:text-2xl"},"⚔️")])],-1)),e("div",null,[e("div",ts,n(h.value),1),t[41]||(t[41]=e("div",{class:"text-xs sm:text-sm text-slate-500"},"见习剑客",-1))])]),e("div",ss,[e("div",as," 第 "+n(((J=k.value)==null?void 0:J.id)||"?")+" 章 ",1),e("button",{onClick:Ae,class:b(["px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg sm:rounded-xl border transition-colors duration-200 text-sm",[g.value==="deepseek-r1"?"bg-purple-50 text-purple-700 border-purple-200":"bg-blue-50 text-blue-700 border-blue-200"]])},n(g.value),3),e("button",{onClick:$e,class:"group px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg sm:rounded-xl bg-slate-50 border border-slate-200 text-slate-700 hover:bg-slate-100 transition-all duration-300 text-sm"},t[43]||(t[43]=[e("span",{class:"flex items-center gap-2"},[e("span",{class:"text-base sm:text-lg group-hover:rotate-180 transition-transform duration-500"},"🔄"),e("span",{class:"hidden sm:inline"},"重新开始")],-1)])),e("button",{onClick:ge,class:"group px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg sm:rounded-xl bg-indigo-50 border border-indigo-200 text-indigo-600 hover:bg-indigo-100 transition-all duration-300 text-sm"},t[44]||(t[44]=[e("span",{class:"flex items-center gap-2"},[e("span",{class:"text-base sm:text-lg"},"🏠"),e("span",{class:"hidden sm:inline"},"返回首页")],-1)]))])])]),e("div",ls,[e("div",os,[e("div",is,[e("button",{onClick:t[7]||(t[7]=v=>ue("dialog")),class:b(["flex-1 py-2 sm:py-3 text-xs sm:text-sm font-medium transition-colors duration-200 relative",x.value==="dialog"?"text-indigo-600 bg-indigo-50/50":"text-slate-600 hover:text-slate-800 hover:bg-slate-50"])},[t[45]||(t[45]=e("span",{class:"flex items-center justify-center gap-1 sm:gap-2"},[e("span",{class:"text-base sm:text-lg"},"💭"),e("span",null,"对话内容")],-1)),x.value==="dialog"?(l(),a("span",ns)):d("",!0)],2),g.value!=="deepseek-chat"?(l(),a("button",{key:0,onClick:t[8]||(t[8]=v=>ue("reasoning")),class:b(["flex-1 py-2 sm:py-3 text-xs sm:text-sm font-medium transition-colors duration-200 relative",x.value==="reasoning"?"text-purple-600 bg-purple-50/50":"text-slate-600 hover:text-slate-800 hover:bg-slate-50"])},[e("span",rs,[t[47]||(t[47]=e("span",{class:"text-base sm:text-lg"},"🤔",-1)),t[48]||(t[48]=e("span",null,"思维过程",-1)),G.value&&!K.value?(l(),a("span",ds,t[46]||(t[46]=[w(" 思考中 "),e("span",{class:"ml-1 flex space-x-1"},[e("span",{class:"w-1 h-1 bg-purple-700 rounded-full animate-bounce",style:{"animation-delay":"0s"}}),e("span",{class:"w-1 h-1 bg-purple-700 rounded-full animate-bounce",style:{"animation-delay":"0.1s"}}),e("span",{class:"w-1 h-1 bg-purple-700 rounded-full animate-bounce",style:{"animation-delay":"0.2s"}})],-1)]))):d("",!0)]),x.value==="reasoning"?(l(),a("span",us)):d("",!0)],2)):d("",!0),T.value.show?(l(),a("button",{key:1,onClick:t[9]||(t[9]=v=>ue("error")),class:b(["flex-1 py-2 sm:py-3 text-xs sm:text-sm font-medium transition-colors duration-200 relative",x.value==="error"?"text-red-600 bg-red-50/50":"text-slate-600 hover:text-slate-800 hover:bg-slate-50"])},[t[49]||(t[49]=e("span",{class:"flex items-center justify-center gap-1 sm:gap-2"},[e("span",{class:"text-base sm:text-lg"},"⚠️"),e("span",null,"错误信息")],-1)),x.value==="error"?(l(),a("span",gs)):d("",!0)],2)):d("",!0)]),e("div",vs,[x.value==="dialog"?(l(),a("div",ms,[e("div",ps,[t[54]||(t[54]=e("div",{class:"text-xl sm:text-2xl shrink-0"},"💭",-1)),D.value&&!C.value?(l(),a("div",cs,t[50]||(t[50]=[N('<div class="flex items-center text-slate-500 text-sm sm:text-base" data-v-0187d014><span data-v-0187d014>AI正在生成对话</span><span class="ml-2 flex space-x-1" data-v-0187d014><span class="w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce" style="animation-delay:0s;" data-v-0187d014></span><span class="w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce" style="animation-delay:0.1s;" data-v-0187d014></span><span class="w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce" style="animation-delay:0.2s;" data-v-0187d014></span></span></div>',1)]))):d("",!0),C.value?(l(),a("div",xs,n(C.value),1)):(B=k.value)!=null&&B.dialog?(l(),a("div",bs,n(k.value.dialog),1)):S.value&&S.value.includes("修复")?(l(),a("div",fs,t[51]||(t[51]=[e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-lg"},"🔧"),e("span",null,"正在修复对话内容...")],-1)]))):S.value?(l(),a("div",hs,[e("div",ys,[t[52]||(t[52]=e("span",{class:"text-lg"},"⚠️",-1)),e("span",null,n(S.value),1)])])):(l(),a("div",ws,t[53]||(t[53]=[e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-lg"},"💭"),e("span",null,"等待对话内容...")],-1)])))])])):x.value==="reasoning"?(l(),a("div",ks,[e("div",_s,[t[56]||(t[56]=e("div",{class:"text-xl sm:text-2xl shrink-0"},"🤔",-1)),D.value&&!K.value?(l(),a("div",Ss,t[55]||(t[55]=[N('<div class="flex items-center text-slate-500 text-sm sm:text-base" data-v-0187d014><span data-v-0187d014>AI正在生成思维过程</span><span class="ml-2 flex space-x-1" data-v-0187d014><span class="w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce" style="animation-delay:0s;" data-v-0187d014></span><span class="w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce" style="animation-delay:0.1s;" data-v-0187d014></span><span class="w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce" style="animation-delay:0.2s;" data-v-0187d014></span></span></div>',1)]))):d("",!0),e("p",Is,n(K.value||(k.value?k.value.reasoning:"")),1)])])):x.value==="error"?(l(),a("div",Ps,[e("div",js,[e("div",Cs,[t[59]||(t[59]=e("div",{class:"text-xl sm:text-2xl text-red-500 shrink-0"},"⚠️",-1)),e("div",null,[e("h3",$s,[e("span",null,"错误 "+n(T.value.code),1),T.value.details?(l(),a("span",As,"- "+n(T.value.details.title),1)):d("",!0)]),e("p",Ms,n(T.value.message),1),T.value.details?(l(),a("div",Ks,[e("p",null,[t[57]||(t[57]=e("span",{class:"font-medium"},"原因：",-1)),e("span",null,n(T.value.details.reason),1)]),e("p",null,[t[58]||(t[58]=e("span",{class:"font-medium"},"解决方法：",-1)),e("span",null,n(T.value.details.solution),1)])])):d("",!0),e("div",{class:"mt-3 sm:mt-4"},[e("button",{onClick:ee,class:"px-3 py-1 text-xs rounded bg-red-100 text-red-700 hover:bg-red-200 transition-colors"}," 关闭错误提示 ")])])])])])):d("",!0)])]),e("div",Ts,[t[66]||(t[66]=e("div",{class:"absolute top-0 left-0 w-full h-[2px] bg-gradient-to-r from-transparent via-indigo-300 to-transparent opacity-70"},null,-1)),t[67]||(t[67]=e("div",{class:"absolute bottom-0 right-0 w-full h-[2px] bg-gradient-to-r from-blue-300 via-transparent to-transparent opacity-70"},null,-1)),t[68]||(t[68]=e("div",{class:"absolute -top-20 -right-20 w-64 h-64 bg-blue-500/5 rounded-full blur-3xl group-hover:bg-blue-500/10 transition-all duration-700"},null,-1)),t[69]||(t[69]=e("div",{class:"absolute -bottom-32 -left-20 w-80 h-80 bg-indigo-500/5 rounded-full blur-3xl group-hover:bg-indigo-500/10 transition-all duration-700"},null,-1)),e("div",Gs,[t[65]||(t[65]=e("div",{class:"flex-shrink-0 w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-md shadow-indigo-200/30 mr-4 sm:mr-5"},[e("span",{class:"text-white text-xl"},"📜")],-1)),e("div",Es,[t[64]||(t[64]=e("h3",{class:"font-bold text-indigo-700 text-lg sm:text-xl mb-3 bg-clip-text text-transparent bg-gradient-to-r from-indigo-700 to-blue-700"},"当前场景",-1)),(I=k.value)!=null&&I.description?(l(),a("div",Ds,n(k.value.description),1)):D.value?(l(),a("div",Qs,t[60]||(t[60]=[N('<div class="flex items-center gap-2" data-v-0187d014><span data-v-0187d014>AI正在生成场景描述</span><span class="flex space-x-1" data-v-0187d014><span class="w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce" style="animation-delay:0s;" data-v-0187d014></span><span class="w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce" style="animation-delay:0.1s;" data-v-0187d014></span><span class="w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce" style="animation-delay:0.2s;" data-v-0187d014></span></span></div>',1)]))):S.value&&S.value.includes("修复")?(l(),a("div",Ns,[e("div",Us,[t[61]||(t[61]=e("span",{class:"text-lg"},"🔧",-1)),e("span",null,n(S.value),1)])])):S.value?(l(),a("div",zs,[e("div",Bs,[e("div",Vs,[t[62]||(t[62]=e("span",{class:"text-lg"},"⚠️",-1)),e("span",null,n(S.value),1)]),e("button",{onClick:ye,class:"px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors text-xs"}," 重试 ")])])):(l(),a("div",Os,t[63]||(t[63]=[e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-lg"},"📝"),e("span",null,"等待场景内容...")],-1)])))])])]),e("div",qs,[t[76]||(t[76]=N('<div class="absolute top-0 right-0 w-full h-[2px] bg-gradient-to-r from-indigo-300 via-purple-300/70 to-transparent opacity-70" data-v-0187d014></div><div class="absolute bottom-0 left-0 w-full h-[2px] bg-gradient-to-r from-transparent via-blue-300/70 to-indigo-300 opacity-70" data-v-0187d014></div><div class="absolute -top-24 -left-20 w-72 h-72 bg-indigo-500/5 rounded-full blur-3xl group-hover:bg-indigo-500/10 transition-all duration-700" data-v-0187d014></div><div class="absolute -bottom-32 -right-20 w-80 h-80 bg-purple-500/5 rounded-full blur-3xl group-hover:bg-purple-500/10 transition-all duration-700" data-v-0187d014></div><div class="absolute top-4 right-4 text-4xl opacity-5 group-hover:opacity-10 transition-opacity duration-700 transform rotate-12" data-v-0187d014>💬</div>',5)),e("div",Ls,[t[75]||(t[75]=e("div",{class:"flex-shrink-0 mr-4 sm:mr-5"},[e("div",{class:"w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center shadow-md shadow-indigo-200/30 p-0.5"},[e("div",{class:"w-full h-full rounded-full bg-white/90 flex items-center justify-center"},[e("span",{class:"text-indigo-600 text-xl"},"💭")])])],-1)),e("div",Rs,[t[74]||(t[74]=e("h3",{class:"font-bold text-purple-700 text-lg sm:text-xl mb-3 bg-clip-text text-transparent bg-gradient-to-r from-indigo-600 to-purple-600"},"对话内容",-1)),e("div",Hs,[(_=k.value)!=null&&_.dialog?(l(),a("div",Js,n(k.value.dialog),1)):C.value?(l(),a("div",Ws,n(C.value),1)):D.value?(l(),a("div",Fs,t[70]||(t[70]=[N('<div class="flex items-center gap-2" data-v-0187d014><span data-v-0187d014>AI正在生成对话内容</span><span class="flex space-x-1" data-v-0187d014><span class="w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce" style="animation-delay:0s;" data-v-0187d014></span><span class="w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce" style="animation-delay:0.1s;" data-v-0187d014></span><span class="w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce" style="animation-delay:0.2s;" data-v-0187d014></span></span></div>',1)]))):S.value&&S.value.includes("修复")?(l(),a("div",Xs,t[71]||(t[71]=[e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-lg"},"🔧"),e("span",null,"正在修复内容格式...")],-1)]))):S.value?(l(),a("div",Ys,[e("div",Zs,[t[72]||(t[72]=e("span",{class:"text-lg"},"⚠️",-1)),e("span",null,n(S.value),1)])])):(l(),a("div",ea,t[73]||(t[73]=[e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-lg"},"💭"),e("span",null,"等待对话内容...")],-1)])))])])])]),(P=k.value)!=null&&P.specialEvent?(l(),a("div",ta,[t[79]||(t[79]=e("div",{class:"absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-indigo-200 to-blue-200"},null,-1)),e("div",sa,[t[78]||(t[78]=e("div",{class:"text-xl sm:text-2xl"},"⚡",-1)),e("div",null,[t[77]||(t[77]=e("h3",{class:"font-bold text-slate-800 mb-2 text-sm sm:text-base"},"特殊事件",-1)),e("p",aa,n((Q=k.value)==null?void 0:Q.specialEvent),1)])])])):d("",!0),e("div",la,[e("div",oa,[e("div",ia,[t[80]||(t[80]=e("span",null,"游戏技能",-1)),e("span",{class:b(["font-medium",{"text-blue-600":o.value.gaming>=100}])},n(o.value.gaming)+"%",3)]),e("div",na,[e("div",{class:b(["h-2 rounded-full transition-all duration-700 ease-out",[o.value.gaming>=100?"bg-gradient-to-r from-blue-400 via-blue-500 to-indigo-500 animate-pulse":"bg-blue-500"]]),style:q(`width: ${o.value.gaming}%`)},null,6)]),o.value.gaming>=100?(l(),a("div",ra,t[81]||(t[81]=[e("div",{class:"absolute -inset-1 bg-gradient-to-r from-blue-400 to-indigo-500 opacity-20 blur-xl"},null,-1),e("div",{class:"absolute top-1 right-2 text-xs font-bold text-blue-600 animate-bounce"},"满级!",-1)]))):d("",!0)]),e("div",da,[e("div",ua,[t[82]||(t[82]=e("span",null,"学习能力",-1)),e("span",{class:b(["font-medium",{"text-green-600":o.value.study>=100}])},n(o.value.study)+"%",3)]),e("div",ga,[e("div",{class:b(["h-2 rounded-full transition-all duration-700 ease-out",[o.value.study>=100?"bg-gradient-to-r from-green-400 via-green-500 to-emerald-500 animate-pulse":"bg-green-500"]]),style:q(`width: ${o.value.study}%`)},null,6)]),o.value.study>=100?(l(),a("div",va,t[83]||(t[83]=[e("div",{class:"absolute -inset-1 bg-gradient-to-r from-green-400 to-emerald-500 opacity-20 blur-xl"},null,-1),e("div",{class:"absolute top-1 right-2 text-xs font-bold text-green-600 animate-bounce"},"满级!",-1)]))):d("",!0)]),e("div",ma,[e("div",pa,[t[84]||(t[84]=e("span",null,"社交关系",-1)),e("span",{class:b(["font-medium",{"text-purple-600":o.value.social>=100}])},n(o.value.social)+"%",3)]),e("div",ca,[e("div",{class:b(["h-2 rounded-full transition-all duration-700 ease-out",[o.value.social>=100?"bg-gradient-to-r from-purple-400 via-purple-500 to-indigo-500 animate-pulse":"bg-purple-500"]]),style:q(`width: ${o.value.social}%`)},null,6)]),o.value.social>=100?(l(),a("div",xa,t[85]||(t[85]=[e("div",{class:"absolute -inset-1 bg-gradient-to-r from-purple-400 to-indigo-500 opacity-20 blur-xl"},null,-1),e("div",{class:"absolute top-1 right-2 text-xs font-bold text-purple-600 animate-bounce"},"满级!",-1)]))):d("",!0)]),e("div",ba,[e("div",fa,[t[86]||(t[86]=e("span",null,"神秘能力",-1)),e("span",{class:b(["font-medium",{"text-amber-600":o.value.other>=100}])},n(o.value.other)+"%",3)]),e("div",ha,[e("div",{class:b(["h-2 rounded-full transition-all duration-700 ease-out",[o.value.other>=100?"bg-gradient-to-r from-amber-400 via-amber-500 to-orange-500 animate-pulse":"bg-amber-500"]]),style:q(`width: ${o.value.other}%`)},null,6)]),o.value.other>=100?(l(),a("div",ya,t[87]||(t[87]=[e("div",{class:"absolute -inset-1 bg-gradient-to-r from-amber-400 to-orange-500 opacity-20 blur-xl"},null,-1),e("div",{class:"absolute top-1 right-2 text-xs font-bold text-amber-600 animate-bounce"},"满级!",-1)]))):d("",!0)])]),e("div",{class:b(["space-y-3 sm:space-y-4",{"opacity-50 pointer-events-none":D.value}])},[(l(!0),a(U,null,ke(((oe=k.value)==null?void 0:oe.options)||[],(v,j)=>(l(),a("div",{key:`option-${j}-${v.text}`,class:"group cursor-pointer relative overflow-hidden touch-manipulation",onClick:Wa=>!D.value&&je(v)},[t[89]||(t[89]=e("div",{class:"absolute inset-0 bg-gradient-to-r from-indigo-50 to-blue-50 rounded-xl sm:rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1)),e("div",ka,[e("div",_a,n(v.text),1),v.hint?(l(),a("div",Sa,n(v.hint),1)):d("",!0),D.value?(l(),a("div",Ia,t[88]||(t[88]=[e("div",{class:"w-4 h-4 rounded-full bg-slate-200 flex items-center justify-center"},[e("div",{class:"w-2 h-2 rounded-full bg-slate-400 animate-pulse"})],-1)]))):d("",!0)])],8,wa))),128)),!D.value&&((ie=k.value)==null?void 0:ie.id)===999?(l(),a("div",Pa,[e("div",{class:"bg-gradient-to-br from-indigo-50 to-purple-50 border border-indigo-200 rounded-xl p-8"},[t[90]||(t[90]=e("div",{class:"text-4xl mb-4"},"🎉",-1)),t[91]||(t[91]=e("div",{class:"text-indigo-800 font-bold text-xl mb-4"},"游戏结束",-1)),t[92]||(t[92]=e("div",{class:"text-indigo-600 mb-6"},"恭喜你完成了剑道传奇的故事！",-1)),e("button",{onClick:ge,class:"px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl font-medium hover:from-indigo-500 hover:to-purple-500 transition-all duration-300"}," 重新开始 ")])])):!D.value&&(!((te=k.value)!=null&&te.options)||k.value.options.length===0)?(l(),a("div",ja,[e("div",{class:"bg-red-50 border border-red-200 rounded-xl p-6"},[t[93]||(t[93]=e("div",{class:"text-red-600 text-lg mb-2"},"⚠️",-1)),t[94]||(t[94]=e("div",{class:"text-red-700 font-medium mb-2"},"场景选项加载失败",-1)),t[95]||(t[95]=e("div",{class:"text-red-600 text-sm mb-4"},"可能是API响应格式错误或网络问题",-1)),e("button",{onClick:ye,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"}," 重新生成场景 ")])])):d("",!0)],2)])])]),X.value?(l(),a("div",{key:0,class:"fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center z-50",onClick:t[11]||(t[11]=v=>X.value=!1)},[e("div",{class:"relative bg-white rounded-xl sm:rounded-2xl p-6 sm:p-8 max-w-xs sm:max-w-md w-full mx-4 shadow-xl",onClick:t[10]||(t[10]=Qe(()=>{},["stop"]))},[t[103]||(t[103]=e("h2",{class:"text-xl sm:text-2xl font-bold text-slate-800 mb-4"},"AI模型信息",-1)),e("div",Ca,[e("div",null,[t[96]||(t[96]=e("h3",{class:"text-xs sm:text-sm font-medium text-slate-500"},"当前模型",-1)),e("p",$a,n(g.value),1)]),e("div",null,[t[102]||(t[102]=e("h3",{class:"text-xs sm:text-sm font-medium text-slate-500"},"模型特点",-1)),e("ul",Aa,[g.value==="deepseek-r1"?(l(),a("li",Ma,t[97]||(t[97]=[e("span",{class:"text-purple-500 mt-0.5"},"✓",-1),e("span",{class:"text-slate-700 text-xs sm:text-sm"},"支持思维链展示，可观察AI思考过程",-1)]))):d("",!0),g.value==="deepseek-r1"?(l(),a("li",Ka,t[98]||(t[98]=[e("span",{class:"text-purple-500 mt-0.5"},"✓",-1),e("span",{class:"text-slate-700 text-xs sm:text-sm"},"更强的推理和剧情架构能力",-1)]))):d("",!0),g.value==="deepseek-chat"?(l(),a("li",Ta,t[99]||(t[99]=[e("span",{class:"text-blue-500 mt-0.5"},"✓",-1),e("span",{class:"text-slate-700 text-xs sm:text-sm"},"更流畅的对话体验",-1)]))):d("",!0),g.value==="QwQ-32B"?(l(),a("li",Ga,t[100]||(t[100]=[e("span",{class:"text-blue-500 mt-0.5"},"✓",-1),e("span",{class:"text-slate-700 text-xs sm:text-sm"},"更大模型参数，知识面更广",-1)]))):d("",!0),t[101]||(t[101]=e("li",{class:"flex items-start gap-2"},[e("span",{class:"text-green-500 mt-0.5"},"✓"),e("span",{class:"text-slate-700 text-xs sm:text-sm"},"实时流式生成，响应更快")],-1))])]),e("div",{class:"pt-4"},[e("button",{onClick:Me,class:"w-full py-3 bg-gradient-to-r from-indigo-500 to-blue-500 text-white rounded-xl font-medium text-sm sm:text-base"}," 切换模型 ")])])])])):d("",!0),D.value&&!E.value?(l(),a("div",Ea,[e("div",Da,[e("div",Qa,[t[104]||(t[104]=N('<div class="w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-3 sm:mb-4" data-v-0187d014><svg class="animate-spin w-full h-full text-indigo-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-0187d014><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-0187d014></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" data-v-0187d014></path></svg></div><p class="text-slate-800 text-base sm:text-lg font-medium text-center" data-v-0187d014>正在书写剧情...</p>',2)),e("p",Na,[x.value==="reasoning"?(l(),a("span",Ua,"正在思考中，请稍候...")):(l(),a("span",za,"AI正在创作，故事即将呈现..."))]),t[105]||(t[105]=e("div",{class:"w-full h-1 bg-slate-100 rounded-full mt-4 overflow-hidden"},[e("div",{class:"h-full bg-indigo-400 rounded-full animate-progressBar"})],-1))])])])):d("",!0),S.value?(l(),a("div",Ba,[e("div",Va,[e("div",Oa,[t[106]||(t[106]=e("span",{class:"text-lg sm:text-xl"},"❌",-1)),e("span",qa,n(S.value),1)])])])):d("",!0)]))])}}}),Ra=Ie(La,[["__scopeId","data-v-0187d014"]]),Ha={class:"game-view-container"},Ja=_e({__name:"GameView",setup(y){const f=Be(),u=p(f.apiUrl);return Se(()=>{const h=localStorage.getItem("apiUrl");h&&(u.value=h,f.setApiUrl(h))}),(h,V)=>(l(),a("div",Ha,[Ne(Ra,{"api-base-url":u.value},null,8,["api-base-url"])]))}}),el=Ie(Ja,[["__scopeId","data-v-d88ade8b"]]);export{el as default};
